fabric.Postit=fabric.util.createClass(fabric.Group,{type:"postit",initialize(b,c){this.tbox=new fabric.Textbox(b,{left:0,top:0,originY:"center",originX:"center",textAlign:"center",padding:10,fontSize:20,fontFamily:"Sans-serif",fontStyle:"normal"});this.note=new fabric.Rect({left:0,top:0,originY:"top",originX:"center",fill:"#ffffaa",rx:5,ry:5});this.strip=new fabric.Rect({left:0,top:0,originY:"top",originX:"center",height:30,fill:"#ffff00"});Object.defineProperty(this,"text",{get:()=>this.tbox.text,
set:a=>this.tbox.set("text",a)});Object.defineProperty(this,"textPadding",{get:()=>this.tbox.padding,set:a=>this.tbox.set("padding",a)});Object.defineProperty(this,"textAlign",{get:()=>this.tbox.textAlign,set:a=>this.tbox.set("textAlign",a)});Object.defineProperty(this,"fontSize",{get:()=>this.tbox.fontSize,set:a=>this.tbox.set("fontSize",a)});Object.defineProperty(this,"fontStyle",{get:()=>this.tbox.fontStyle,set:a=>this.tbox.set("fontStyle",a)});Object.defineProperty(this,"fontFamily",{get:()=>
this.tbox.fontFamily,set:a=>this.tbox.set("fontFamily",a)});Object.defineProperty(this,"textColor",{get:()=>this.tbox.fill,set:a=>this.tbox.set("fill",a)});Object.defineProperty(this,"noteColor",{get:()=>this.note.fill,set:a=>this.note.set("fill",a)});Object.defineProperty(this,"boxShadow",{get:()=>this.shadow,set:a=>this.set("shadow",a)});Object.defineProperty(this,"radius",{get:()=>this.note.rx,set:a=>this.note.set({rx:a,ry:a})});Object.defineProperty(this,"stripHeight",{get:()=>this.strip.height,
set:a=>this.strip.set("height",a)});Object.defineProperty(this,"stripColor",{get:()=>this.strip.fill,set:a=>this.strip.set("fill",a)});this.on("scaling",this._onScale.bind(this));this.on("mousedblclick",this._enterEditing.bind(this));this.tbox.on("changed",this._onChange.bind(this));this.tbox.on("selection:changed",this._onChange.bind(this));this.callSuper("initialize",[this.note,this.strip,this.tbox],{lockScalingFlip:!0,shadow:"rgba(0,0,0,0.3) 3px 3px 3px",...c});this.setCoords()},_enterEditing(){this.canvas.setActiveObject(this.tbox);
this.tbox.bringToFront();this.tbox.enterEditing();this.tbox.selectAll();this._onChange()},_onChange(){this.setCoords()},_onScale(){this.set({scaleX:1,scaleY:1,width:this.width*Math.abs(this.scaleX),height:this.height*Math.abs(this.scaleY)});this.setCoords()},setCoords(){this.tbox.set({top:this.strip.height/2,width:this.width-2*this.tbox.padding,height:this.height-this.strip.height-2*this.tbox.padding});this.tbox.setCoords();const b=this.tbox.width+2*this.tbox.padding,c=Math.max(this.tbox.height+this.strip.height+
2*this.tbox.padding,this.height);this.set({scaleX:1,scaleY:1,width:b,height:c});this.note.set({width:b,height:c,top:-c/2});this.strip.set({width:b,top:-this.height/2});this.callSuper("setCoords");this.canvas?.requestRenderAll()},toObject(b){b=["text","textPadding","textAlign","fontSize","fontFamily","textColor","noteColor","boxShadow","radius","stripHeight","stripColor",...(b??[])];return fabric.util.object.extend(this.callSuper("toObject",b))}});
fabric.Postit.fromObject=function(b,c){return fabric.Object._fromObject("Postit",b,c,"text")};
